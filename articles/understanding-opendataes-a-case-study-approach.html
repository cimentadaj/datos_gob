<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Understanding opendataes: a case study approach • opendataes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Understanding opendataes: a case study approach">
<meta property="og:description" content="opendataes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">opendataes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ins-and-outs-of-opendataes-guide-for-collaboration.html">Ins and outs  of opendataes: a guide for collaboration</a>
    </li>
    <li>
      <a href="../articles/understanding-opendataes-a-case-study-approach.html">Understanding opendataes: a case study approach</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropenspain/opendataes/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Understanding opendataes: a case study approach</h1>
                        <h4 class="author">Jorge Cimentada and Jorge Lopez</h4>
            
            <h4 class="date">2020-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropenspain/opendataes/blob/master/vignettes/understanding-opendataes-a-case-study-approach.Rmd"><code>vignettes/understanding-opendataes-a-case-study-approach.Rmd</code></a></small>
      <div class="hidden name"><code>understanding-opendataes-a-case-study-approach.Rmd</code></div>

    </div>

    
    
<div id="understanding-opendataes" class="section level2">
<h2 class="hasAnchor">
<a href="#understanding-opendataes" class="anchor"></a>Understanding opendataes</h2>
<p>The idea behind <code>opendataes</code> is to allow users to read datasets as easy as possible while providing a stable and predictable behaviour. This is a bit tricky given that <a href="https://datos.gob.es" class="uri">https://datos.gob.es</a> aggregates from many different API’s which don’t have a unified standardized behavior. That is, each entity does not conform to a centralized guideline to their data format. In this vignette we’ll explore how we can read data using <code>openes_load</code> but diving into some of the pitfalls of having such an unstandardized API.</p>
<p>First, let’s read through a messy dataset, or in other words, a real-world dataset. An interesting data is one from the Ayuntamiento de Barcelona which details the causes of car accidents in the city. We could do this in two ways: either searching for the direct end path of the URL in <a href="https://datos.gob.es" class="uri">https://datos.gob.es</a> or we could search for the data interactively through keywords.</p>
<p>To search for keywords we need to know in advanced which publisher published the data that we’re looking for. Because only very few (as of October 2018) publishers have standardized datasets across their datasets, <code>opendataes</code> will aggregate new publishers slowly as they can show to provide stableness. We can check out which publishers are available with <code>publishers_available</code>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">opendataes</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Please cite as:</span>
<span class="co">#&gt; Cimentada, J. and Jorge Lopez (2019). Interact with the datos.gob.es API to download public data from all of Spain R package version 0.0.1</span>

<span class="no">publishers_available</span>
<span class="co">#&gt;                                    publishers publisher_code</span>
<span class="co">#&gt; 1                   Ayuntamiento de Barcelona      L01080193</span>
<span class="co">#&gt; 2                      Ayuntamiento de Madrid      L01280796</span>
<span class="co">#&gt; 3                    Ayuntamiento de Valencia      L01462508</span>
<span class="co">#&gt; 4  Ayuntamiento de Las Palmas de Gran Canaria      L01350167</span>
<span class="co">#&gt; 5                      Ayuntamiento de Bilbao      L01480209</span>
<span class="co">#&gt; 6                    Ayuntamiento de Zaragoza      L01502973</span>
<span class="co">#&gt; 7                      Ayuntamiento de Malaga      L01290672</span>
<span class="co">#&gt; 8                       Ayuntamiento de Gijon      L01330241</span>
<span class="co">#&gt; 9                   Ayuntamiento de Santander      L01390759</span>
<span class="co">#&gt; 10                 Ayuntamiento de Alcobendas      L01280066</span></pre></body></html></div>
<p>Let’s subset the code of ‘Ayuntamiento de Barcelona’ and search for the keyword ‘accidentes’ which means accidents.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">pub_code</span> <span class="kw">&lt;-</span> <span class="no">publishers_available</span>$<span class="no">publisher_code</span>[<span class="no">publishers_available</span>$<span class="no">publishers</span> <span class="kw">==</span> <span class="st">'Ayuntamiento de Barcelona'</span>]
<span class="no">kw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/openes_keywords.html">openes_keywords</a></span>(<span class="st">'accidentes'</span>, <span class="no">pub_code</span>)
<span class="co">#&gt; Error in openes_keywords("accidentes", pub_code): There are not datasets matching the keyword `accidentes` and publisher `L01080193`</span></pre></body></html></div>
<p>Alright, so we need to be more creative</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">kw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/openes_keywords.html">openes_keywords</a></span>(<span class="st">'causas accidentes'</span>, <span class="no">pub_code</span>)
<span class="co">#&gt; Error in openes_keywords("causas accidentes", pub_code): There are not datasets matching the keyword `causas accidentes` and publisher `L01080193`</span></pre></body></html></div>
<p>When this happens, it’s just better to search on the website at <a href="https://datos.gob.es" class="uri">https://datos.gob.es</a>. Results there show that some of the keywords are ‘Accidentalidad’, ‘Guardia Urbana’ or ‘Causas’ ( <a href="http://datos.gob.es/es/catalogo/l01080193-descripcion-de-la-causalidad-de-los-accidentes-gestionados-por-la-guardia-urbana-en-la-ciudad-de-barcelona">see here</a>). To showcase how the R-based search works, we’ll continue using the new key words.</p>
<p>Side note: Why should we do the keyword-based search if we can use the website directly? Because you can use more generic keywords to look for similar datasets. For example, if we searched for ‘elecciones’ (elections) we would get many different datasets related to elections which could be streamlined to <code>openes_load</code> for easy reading. By doing it manually, you’d have to search each datasets separately and copy it’s end path.</p>
<p>Moving on to the keyword search, we type in the new keyword.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">kw</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/openes_keywords.html">openes_keywords</a></span>(<span class="st">'Accidentalidad'</span>, <span class="no">pub_code</span>)
<span class="no">kw</span>
<span class="co">#&gt; # A tibble: 5 x 5</span>
<span class="co">#&gt;   description           publisher    is_readable path_id          url           </span>
<span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt;        &lt;lgl&gt;       &lt;chr&gt;            &lt;chr&gt;         </span>
<span class="co">#&gt; 1 Listado de los accid… Ayuntamient… TRUE        l01080193-accid… http://datos.…</span>
<span class="co">#&gt; 2 Listado de los vehíc… Ayuntamient… TRUE        l01080193-vehic… http://datos.…</span>
<span class="co">#&gt; 3 Personas involucrada… Ayuntamient… TRUE        l01080193-perso… http://datos.…</span>
<span class="co">#&gt; 4 Listado de  de la ca… Ayuntamient… TRUE        l01080193-descr… http://datos.…</span>
<span class="co">#&gt; 5 Listado de los tipos… Ayuntamient… TRUE        l01080193-accid… http://datos.…</span></pre></body></html></div>
<p>Looking at the description column, we can see the dataset that we’re looking for which states ‘Listado de los tipos de accidentes gestionados por la Guardia Urbana en la ciudad de Barcelona’. Let’s filter down only to that dataset and pass it to <code>openes_load</code>. Note that <code>openes_load</code> will throw an error if you ever pass this dataset with more than one row. It will only read one dataset and that implies a dataset with only one row.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">kw</span> <span class="kw">&lt;-</span> <span class="no">kw</span>[<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">'Listado de los tipos de accidentes gestionados por la Guardia Urbana en la ciudad de Barcelona.'</span>, <span class="no">kw</span>$<span class="no">description</span>), ]
<span class="no">accidents</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/openes_load.html">openes_load</a></span>(<span class="no">kw</span>)

<span class="no">accidents</span>
<span class="co">#&gt; &lt;datos.gob.es API&gt;</span>
<span class="co">#&gt;    Description: Listado de los tipos de accidentes gestionados por la Guardia ...</span>
<span class="co">#&gt;    Publisher: Ayuntamiento de Barcelona</span>
<span class="co">#&gt;    Languages: en, es, ca</span>
<span class="co">#&gt;    Date of release: 2015-11-18 23:00:00</span>
<span class="co">#&gt;    # of files read: 4 out of 9</span></pre></body></html></div>
<p>The printed metadata from above is just a summary of the metadata slot:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">accidents</span>$<span class="no">metadata</span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   keywords language description url   date_issued         date_modified</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;        </span>
<span class="co">#&gt; 1 Acciden… en       List of ty… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; 2 Acciden… es       Listado de… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; 3 Acciden… ca       Llistat de… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; # … with 2 more variables: publisher &lt;chr&gt;, publisher_data_url &lt;chr&gt;</span></pre></body></html></div>
<p>and the data slot:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">accidents</span>$<span class="no">data</span>
<span class="co">#&gt; $`2011_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2016_ACCIDENTS_TIPUS_GU_BCN.csv`</span>
<span class="co">#&gt; # A tibble: 10,701 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2016S002575                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  2 2016S001146                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  3 2016S009619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2016S003881                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2016S004162                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2016S009951                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2016S004619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2016S009702                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2016S003529                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2016S008654                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,691 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2018_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 10,551 x 22</span>
<span class="co">#&gt;    Codi_expedient Codi_districte Nom_districte Codi_barri Nom_barri Codi_carrer</span>
<span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2018S000001                 3 Sants-Montju…         11 el Poble…      198804</span>
<span class="co">#&gt;  2 2018S000002                 2 Eixample               9 la Nova …      361406</span>
<span class="co">#&gt;  3 2018S000003                10 Sant Martí            64 el Camp …      161407</span>
<span class="co">#&gt;  4 2018S000004                 8 Nou Barris            44 Vilapici…      111704</span>
<span class="co">#&gt;  5 2018S000005                 8 Nou Barris            56 Vallbona       330606</span>
<span class="co">#&gt;  6 2018S000006                 4 Les Corts             19 les Corts      144601</span>
<span class="co">#&gt;  7 2018S000007                10 Sant Martí            73 la Verne…       60807</span>
<span class="co">#&gt;  8 2018S000008                 3 Sants-Montju…         17 Sants - …      312400</span>
<span class="co">#&gt;  9 2018S000009                 2 Eixample              10 Sant Ant…      323203</span>
<span class="co">#&gt; 10 2018S000010                 8 Nou Barris            45 Porta          100209</span>
<span class="co">#&gt; # … with 10,541 more rows, and 16 more variables: Nom_carrer &lt;chr&gt;,</span>
<span class="co">#&gt; #   Num_postal &lt;chr&gt;, Dia_setmana &lt;chr&gt;, ID_Dia_setmana &lt;chr&gt;, Tipus_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Any &lt;dbl&gt;, Mes &lt;dbl&gt;, Nom_mes &lt;chr&gt;, Dia_de_mes &lt;dbl&gt;, Hora_de_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Torn &lt;chr&gt;, Tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2013_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2010_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2014_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2015_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 10,521 x 20</span>
<span class="co">#&gt;    `Número d'exped… `Codi districte` `Nom districte` `Codi barri` `Nom barri`</span>
<span class="co">#&gt;    &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;      </span>
<span class="co">#&gt;  1 2015S000215                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  2 2015S000787                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  3 2015S000390                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  4 2015S007294                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  5 2015S009836                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  6 2015S009453                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  7 2015S007312                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  8 2015S004660                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  9 2015S006407                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; 10 2015S009834                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; # … with 10,511 more rows, and 15 more variables: `Codi carrer` &lt;dbl&gt;, `Nom</span>
<span class="co">#&gt; #   carrer` &lt;chr&gt;, `Num postal caption` &lt;chr&gt;, `Descripció dia setmana` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Dia setmana` &lt;chr&gt;, `Descripció tipus dia` &lt;chr&gt;, `NK Any` &lt;dbl&gt;, `Mes de</span>
<span class="co">#&gt; #   any` &lt;dbl&gt;, `Nom mes` &lt;chr&gt;, `Dia de mes` &lt;dbl&gt;, `Hora de dia` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Descripció torn` &lt;chr&gt;, `Descripció tipus accident` &lt;chr&gt;, `Coordenada UTM</span>
<span class="co">#&gt; #   (Y)` &lt;dbl&gt;, `Coordenada UTM (X)` &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2017_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 11,009 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2017S009418                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  2 2017S008852                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  3 2017S001023                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2017S009198                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2017S006546                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2017S003698                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2017S004977                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2017S008080                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2017S004521                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2017S004180                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,999 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2012_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span></pre></body></html></div>
<p>Oopss, that’s a weird error. This is one problem that can happen quite often because Spain shares many languages inside it’s territory and some datasets might have different encodings. We can figure out the encoding with <code>readr</code> and just pass it to <code>openes_load</code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># Figure out the encoding using only the first dataset which suggests it's ASCII</span>
<span class="kw pkg">readr</span><span class="kw ns">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/encoding.html">guess_encoding</a></span>(<span class="no">accidents</span>$<span class="no">data</span><span class="kw">[[</span><span class="fl">1</span>]])
<span class="co">#&gt; Warning in if (stringi::stri_enc_isascii(lines)) {: the condition has length &gt; 1</span>
<span class="co">#&gt; and only the first element will be used</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   encoding confidence</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 ASCII             1</span>

<span class="no">accidents</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/openes_load.html">openes_load</a></span>(<span class="no">kw</span>, <span class="kw">encoding</span> <span class="kw">=</span> <span class="st">'ASCII'</span>)</pre></body></html></div>
<p>The result in the data slot is always a list that will contain data frames either with the data (if it was successful in reading it) or with the URL to the dataset (if it failed reading it for some reason).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">accidents</span>$<span class="no">data</span>
<span class="co">#&gt; $`2011_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2016_ACCIDENTS_TIPUS_GU_BCN.csv`</span>
<span class="co">#&gt; # A tibble: 10,701 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2016S002575                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  2 2016S001146                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  3 2016S009619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2016S003881                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2016S004162                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2016S009951                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2016S004619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2016S009702                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2016S003529                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2016S008654                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,691 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2018_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 10,551 x 22</span>
<span class="co">#&gt;    Codi_expedient Codi_districte Nom_districte Codi_barri Nom_barri Codi_carrer</span>
<span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2018S000001                 3 Sants-Montju…         11 el Poble…      198804</span>
<span class="co">#&gt;  2 2018S000002                 2 Eixample               9 la Nova …      361406</span>
<span class="co">#&gt;  3 2018S000003                10 Sant Martí            64 el Camp …      161407</span>
<span class="co">#&gt;  4 2018S000004                 8 Nou Barris            44 Vilapici…      111704</span>
<span class="co">#&gt;  5 2018S000005                 8 Nou Barris            56 Vallbona       330606</span>
<span class="co">#&gt;  6 2018S000006                 4 Les Corts             19 les Corts      144601</span>
<span class="co">#&gt;  7 2018S000007                10 Sant Martí            73 la Verne…       60807</span>
<span class="co">#&gt;  8 2018S000008                 3 Sants-Montju…         17 Sants - …      312400</span>
<span class="co">#&gt;  9 2018S000009                 2 Eixample              10 Sant Ant…      323203</span>
<span class="co">#&gt; 10 2018S000010                 8 Nou Barris            45 Porta          100209</span>
<span class="co">#&gt; # … with 10,541 more rows, and 16 more variables: Nom_carrer &lt;chr&gt;,</span>
<span class="co">#&gt; #   Num_postal &lt;chr&gt;, Dia_setmana &lt;chr&gt;, ID_Dia_setmana &lt;chr&gt;, Tipus_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Any &lt;dbl&gt;, Mes &lt;dbl&gt;, Nom_mes &lt;chr&gt;, Dia_de_mes &lt;dbl&gt;, Hora_de_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Torn &lt;chr&gt;, Tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2013_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2010_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2014_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2015_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 10,521 x 20</span>
<span class="co">#&gt;    `Número d'exped… `Codi districte` `Nom districte` `Codi barri` `Nom barri`</span>
<span class="co">#&gt;    &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;      </span>
<span class="co">#&gt;  1 2015S000215                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  2 2015S000787                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  3 2015S000390                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  4 2015S007294                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  5 2015S009836                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  6 2015S009453                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  7 2015S007312                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  8 2015S004660                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  9 2015S006407                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; 10 2015S009834                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; # … with 10,511 more rows, and 15 more variables: `Codi carrer` &lt;dbl&gt;, `Nom</span>
<span class="co">#&gt; #   carrer` &lt;chr&gt;, `Num postal caption` &lt;chr&gt;, `Descripció dia setmana` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Dia setmana` &lt;chr&gt;, `Descripció tipus dia` &lt;chr&gt;, `NK Any` &lt;dbl&gt;, `Mes de</span>
<span class="co">#&gt; #   any` &lt;dbl&gt;, `Nom mes` &lt;chr&gt;, `Dia de mes` &lt;dbl&gt;, `Hora de dia` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Descripció torn` &lt;chr&gt;, `Descripció tipus accident` &lt;chr&gt;, `Coordenada UTM</span>
<span class="co">#&gt; #   (Y)` &lt;dbl&gt;, `Coordenada UTM (X)` &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2017_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 11,009 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2017S009418                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  2 2017S008852                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  3 2017S001023                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2017S009198                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2017S006546                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2017S003698                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2017S004977                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2017S008080                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2017S004521                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2017S004180                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,999 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2012_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span></pre></body></html></div>
<p>As we can see, the data slot from <code>openes_load</code> read a list of data frames but why so many?</p>
<p>This becomes clear once we look at the website of the dataset we’re reading:</p>
<p><img src="datos_formats.png" align="center"></p>
<p><br><br></p>
<p>As you can see, there are datasets for years 2010, 2011, etc.. where each year is in three different formats (CSV, XLSX and XML as of October 2018).</p>
<p>How does <code>openes_load</code> handle this? Well, to avoid problems between some datasets having slightly different structures between formats, it always aims for the simpler formats in an order of preference. You can check which formats are available with <code>permitted_formats</code> although the user should never have to worry about this because the functions take care of this. However, if you try to read a dataset which only has formats that are not in <code>permitted_formats</code>, <code>openes_load</code> will return the same data structure as if there were a dataset, but the <code>data</code> slot will contain a <code>tibble</code> with the format URL’s of the non-available formats so that the user can read this directly (for example, try reading this <code><a href="../reference/openes_load.html">openes_load('l01080193-carta-arqueologica-de-barcelona')</a></code>).</p>
<p>Coming back to the accidents data, this explains why many datasets were read. We can compare the name of each dataset to figure out what they mean.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">accidents</span>$<span class="no">data</span>)
<span class="co">#&gt; [1] "2011_ACCIDENTS_TIPUS_GU_BCN_.csv" "2016_ACCIDENTS_TIPUS_GU_BCN.csv" </span>
<span class="co">#&gt; [3] "2018_ACCIDENTS_TIPUS_GU_BCN"      "2013_ACCIDENTS_TIPUS_GU_BCN_.csv"</span>
<span class="co">#&gt; [5] "2010_ACCIDENTS_TIPUS_GU_BCN_.csv" "2014_ACCIDENTS_TIPUS_GU_BCN_.csv"</span>
<span class="co">#&gt; [7] "2015_ACCIDENTS_TIPUS_GU_BCN_.csv" "2017_ACCIDENTS_TIPUS_GU_BCN"     </span>
<span class="co">#&gt; [9] "2012_ACCIDENTS_TIPUS_GU_BCN_.csv"</span></pre></body></html></div>
<p>They’re the causes of accidents for different years. Let’s sort them according to the year and check whether all were read.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">accidents</span>$<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">accidents</span>$<span class="no">data</span>[<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">accidents</span>$<span class="no">data</span>))]
<span class="no">accidents</span>$<span class="no">data</span>
<span class="co">#&gt; $`2010_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2011_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2012_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2013_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2014_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   format URL                                                                    </span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;                                                                  </span>
<span class="co">#&gt; 1 csv    https://opendata-ajuntament.barcelona.cat/data/dataset/834b8920-0685-4…</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2015_ACCIDENTS_TIPUS_GU_BCN_.csv`</span>
<span class="co">#&gt; # A tibble: 10,521 x 20</span>
<span class="co">#&gt;    `Número d'exped… `Codi districte` `Nom districte` `Codi barri` `Nom barri`</span>
<span class="co">#&gt;    &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;      </span>
<span class="co">#&gt;  1 2015S000215                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  2 2015S000787                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  3 2015S000390                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  4 2015S007294                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  5 2015S009836                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  6 2015S009453                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  7 2015S007312                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  8 2015S004660                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt;  9 2015S006407                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; 10 2015S009834                    10 Sant Martí                64 el Camp de…</span>
<span class="co">#&gt; # … with 10,511 more rows, and 15 more variables: `Codi carrer` &lt;dbl&gt;, `Nom</span>
<span class="co">#&gt; #   carrer` &lt;chr&gt;, `Num postal caption` &lt;chr&gt;, `Descripció dia setmana` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Dia setmana` &lt;chr&gt;, `Descripció tipus dia` &lt;chr&gt;, `NK Any` &lt;dbl&gt;, `Mes de</span>
<span class="co">#&gt; #   any` &lt;dbl&gt;, `Nom mes` &lt;chr&gt;, `Dia de mes` &lt;dbl&gt;, `Hora de dia` &lt;chr&gt;,</span>
<span class="co">#&gt; #   `Descripció torn` &lt;chr&gt;, `Descripció tipus accident` &lt;chr&gt;, `Coordenada UTM</span>
<span class="co">#&gt; #   (Y)` &lt;dbl&gt;, `Coordenada UTM (X)` &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2016_ACCIDENTS_TIPUS_GU_BCN.csv`</span>
<span class="co">#&gt; # A tibble: 10,701 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2016S002575                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  2 2016S001146                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  3 2016S009619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2016S003881                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2016S004162                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2016S009951                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2016S004619                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2016S009702                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2016S003529                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2016S008654                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,691 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2017_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 11,009 x 22</span>
<span class="co">#&gt;    Numero_expedient Codi_districte Nom_districte Codi_barri Nom_barri</span>
<span class="co">#&gt;    &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1 2017S009418                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  2 2017S008852                  -1 Desconegut            -1 Desconeg…</span>
<span class="co">#&gt;  3 2017S001023                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  4 2017S009198                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  5 2017S006546                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  6 2017S003698                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  7 2017S004977                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  8 2017S008080                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt;  9 2017S004521                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; 10 2017S004180                  10 Sant Martí            64 el Camp …</span>
<span class="co">#&gt; # … with 10,999 more rows, and 17 more variables: Codi_carrer &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_carrer &lt;chr&gt;, Num_postal_caption &lt;chr&gt;, Descripcio_dia_setmana &lt;chr&gt;,</span>
<span class="co">#&gt; #   Dia_setmana &lt;chr&gt;, Descripcio_tipus_dia &lt;chr&gt;, Any &lt;dbl&gt;, Mes_any &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Nom_mes &lt;chr&gt;, Dia_mes &lt;dbl&gt;, Hora_dia &lt;dbl&gt;, Descripcio_torn &lt;chr&gt;,</span>
<span class="co">#&gt; #   Descripcio_tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2018_ACCIDENTS_TIPUS_GU_BCN`</span>
<span class="co">#&gt; # A tibble: 10,551 x 22</span>
<span class="co">#&gt;    Codi_expedient Codi_districte Nom_districte Codi_barri Nom_barri Codi_carrer</span>
<span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2018S000001                 3 Sants-Montju…         11 el Poble…      198804</span>
<span class="co">#&gt;  2 2018S000002                 2 Eixample               9 la Nova …      361406</span>
<span class="co">#&gt;  3 2018S000003                10 Sant Martí            64 el Camp …      161407</span>
<span class="co">#&gt;  4 2018S000004                 8 Nou Barris            44 Vilapici…      111704</span>
<span class="co">#&gt;  5 2018S000005                 8 Nou Barris            56 Vallbona       330606</span>
<span class="co">#&gt;  6 2018S000006                 4 Les Corts             19 les Corts      144601</span>
<span class="co">#&gt;  7 2018S000007                10 Sant Martí            73 la Verne…       60807</span>
<span class="co">#&gt;  8 2018S000008                 3 Sants-Montju…         17 Sants - …      312400</span>
<span class="co">#&gt;  9 2018S000009                 2 Eixample              10 Sant Ant…      323203</span>
<span class="co">#&gt; 10 2018S000010                 8 Nou Barris            45 Porta          100209</span>
<span class="co">#&gt; # … with 10,541 more rows, and 16 more variables: Nom_carrer &lt;chr&gt;,</span>
<span class="co">#&gt; #   Num_postal &lt;chr&gt;, Dia_setmana &lt;chr&gt;, ID_Dia_setmana &lt;chr&gt;, Tipus_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Any &lt;dbl&gt;, Mes &lt;dbl&gt;, Nom_mes &lt;chr&gt;, Dia_de_mes &lt;dbl&gt;, Hora_de_dia &lt;chr&gt;,</span>
<span class="co">#&gt; #   Torn &lt;chr&gt;, Tipus_accident &lt;chr&gt;, Coordenada_UTM_X &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Coordenada_UTM_Y &lt;dbl&gt;, Longitud &lt;dbl&gt;, Latitud &lt;dbl&gt;</span></pre></body></html></div>
<p>But if we look closer, we can see that the data for 2016 and 2017 were not read correctly (as of 2018/10/30). For that case, <code>openes_load</code> returns the link it attempted to read together with the format. For now we’ll exclude these two but the user can read them manually with the provided link. For a simple check, printing the returned object of <code>openes_load</code> will tell you how many files were read.</p>
<p>You can also access the metadata in the metadata slot which contains most of the metadata related to that given dataset. For example..</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">accidents</span>$<span class="no">metadata</span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   keywords language description url   date_issued         date_modified</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;        </span>
<span class="co">#&gt; 1 Acciden… en       List of ty… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; 2 Acciden… es       Listado de… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; 3 Acciden… ca       Llistat de… http… 2015-11-18 23:00:00 No modificat…</span>
<span class="co">#&gt; # … with 2 more variables: publisher &lt;chr&gt;, publisher_data_url &lt;chr&gt;</span></pre></body></html></div>
<p>For a detailed description of what each of these column mean, check the documentation of <code>openes_load</code> with <code><a href="../reference/openes_load.html">?openes_load</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jorge Cimentada, Jorge Lopez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
